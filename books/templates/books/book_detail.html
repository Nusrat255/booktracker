{% extends 'books/base.html' %}
{% block content %}
<h2>{{ book.title }}</h2>
<p><b>Publisher:</b> {{ book.publisher }}</p>
<p><b>Available copies:</b> {{ book.available_copies }}</p>
<p><b>Average rating:</b> ⭐️ {{ book.average_rating }}</p>

{% if user.is_authenticated %}
  <form method="post" action="{% url 'rate_book' book.pk %}">
    {% csrf_token %}
    {{ rating_form.as_p }}
    <button type="submit" class="btn btn-warning">Rate Book</button>
  </form>
  {% if user_rating %}
    <p>Your rating: ⭐️ {{ user_rating.rating }}</p>
  {% endif %}
  <a href="{% url 'borrow_book' book.pk %}" class="btn btn-success">Borrow</a>
  <a href="{% url 'return_book' book.pk %}" class="btn btn-danger">Return</a>
{% else %}
  <p><a href="{% url 'login' %}">Login</a> to rate or borrow books.</p>
{% endif %}
{% endblock %}